# 易居租房平台 - 开发指南

## 项目概述

易居租房平台是一个基于现代Web技术栈的全栈应用，提供房源浏览、搜索、管理和发布功能。

## 技术栈

### 前端技术
- **框架**: React 18 + TypeScript
- **构建工具**: Vite
- **样式**: Tailwind CSS
- **路由**: React Router
- **图标**: Lucide React
- **HTTP客户端**: Axios

### 后端技术
- **运行时**: Node.js
- **框架**: Express.js
- **数据库**: PostgreSQL
- **认证**: JWT
- **文件上传**: Multer

### 开发工具
- **包管理**: npm
- **数据库迁移**: 自定义迁移脚本
- **容器化**: Docker + Docker Compose
- **代码规范**: ESLint

## 开发环境设置

### 1. 环境要求
- Node.js 18+
- PostgreSQL 15+
- npm 9+

### 2. 本地开发设置

```bash
# 克隆项目
git clone <repository-url>
cd easyrent-housing-platform

# 安装依赖
npm run install:all

# 配置环境变量
cp backend/.env.example backend/.env
cp frontend/.env.example frontend/.env

# 启动数据库（确保PostgreSQL运行）
# 创建数据库
createdb easyrent

# 运行数据库迁移
cd backend && npm run db:migrate

# 填充测试数据（可选）
npm run db:seed

# 启动开发服务器
npm run dev
```

### 3. Docker开发环境

```bash
# 使用Docker Compose启动所有服务
docker-compose up -d

# 查看服务状态
docker-compose ps

# 查看日志
docker-compose logs -f
```

## 项目结构说明

```
easyrent-housing-platform/
├── frontend/                 # 前端应用
│   ├── src/
│   │   ├── components/       # 可复用组件
│   │   ├── pages/           # 页面组件
│   │   ├── App.jsx          # 主应用组件
│   │   └── main.jsx         # 应用入口
│   ├── public/              # 静态资源
│   └── package.json
├── backend/                  # 后端API服务
│   ├── src/
│   │   ├── routes/          # API路由
│   │   ├── config/          # 配置文件
│   │   └── server.js        # 服务器入口
│   ├── scripts/             # 工具脚本
│   └── package.json
├── database/                 # 数据库相关
│   └── migrations/          # 数据库迁移文件
├── docs/                    # 项目文档
└── docker-compose.yml       # Docker编排配置
```

## API文档

### 房源相关接口

#### 获取房源列表
- **URL**: `GET /api/listings`
- **参数**:
  - `city` (可选): 城市名称
  - `district` (可选): 区域名称
  - `priceMin`, `priceMax` (可选): 价格范围
  - `page` (可选): 页码，默认1
  - `limit` (可选): 每页数量，默认10

#### 获取房源详情
- **URL**: `GET /api/listings/:id`
- **参数**: 房源ID

### 管理员接口

#### 管理员登录
- **URL**: `POST /api/auth/login`
- **Body**: `{ username, password }`

#### 获取管理员房源列表
- **URL**: `GET /api/admin/listings`
- **Headers**: `Authorization: Bearer <token>`

## 数据库设计

### 主要数据表

#### listings表（房源信息）
- `id`: 主键
- `title`: 房源标题
- `city`, `district`: 城市和区域
- `price`: 月租金
- `house_type`: 户型
- `status`: 状态（draft/published/archived）

#### users表（用户信息）
- `id`: 主键
- `username`, `email`: 登录信息
- `role`: 角色（admin/landlord/agent）

## 开发规范

### 代码风格
- 使用ESLint进行代码检查
- 遵循React Hooks最佳实践
- 组件使用函数式组件和Hooks
- 使用TypeScript进行类型检查

### 提交规范
- 提交信息使用英文描述
- 遵循Conventional Commits规范
- 每次提交只完成一个功能或修复

### 测试
- 前端组件测试使用Jest + React Testing Library
- API测试使用Supertest
- 集成测试使用Cypress

## 部署指南

### 生产环境部署

1. **环境准备**
   - 配置生产环境变量
   - 设置SSL证书
   - 配置域名和CDN

2. **构建部署**
   ```bash
   # 构建应用
   npm run build

   # 使用Docker部署
   docker-compose -f docker-compose.prod.yml up -d
   ```

3. **监控和维护**
   - 设置日志收集
   - 配置性能监控
   - 定期备份数据库

## 常见问题

### Q: 如何添加新的API接口？
A: 在`backend/src/routes/`目录下创建新的路由文件，然后在`server.js`中注册路由。

### Q: 如何修改数据库结构？
A: 创建新的迁移文件在`database/migrations/`目录，然后运行`npm run db:migrate`。

### Q: 如何添加新的页面？
A: 在`frontend/src/pages/`目录下创建新的页面组件，然后在`App.jsx`中添加路由配置。

## 联系方式

如有问题请联系开发团队或查看项目文档。